{% extends "base_public.html" %}
{% load static %}

{% block content %}

<style>
/* HERO */
.cb-hero {
    position: relative;
    min-height: 100vh;
    background: url("{% static 'images/imaged.png' %}") center/cover no-repeat;
    color: #fff;
}

.hero-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.75);
}

.hero-content {
    position: relative;
    z-index: 2;
    text-align: center;
    padding-top: 120px;
}

.brand-title {
    font-size: 3.5rem;
    font-weight: 800;
    letter-spacing: 2px;
}

.brand-subtitle {
    font-size: 1.3rem;
    margin-top: 10px;
}

.brand-tagline {
    color: #cbd5e1;
}

/* BUTTONS */
.hero-actions {
    margin-top: 90px;

}

/* QUICK ACTIONS */
.quick-actions {
    padding: 80px 0;
    background: #f8fafc;
}

.action-card {
    background: #fff;
    padding: 25px;
    border-radius: 14px;
    
    box-shadow: 0 8px 22px rgba(0,0,0,0.08);
    transition: transform .3s;
}

.action-card:hover {
    transform: translateY(-6px);
}

/* UPDATES */
.school-updates {
    padding: 80px 0;
}

.section-title {
    font-weight: 700;
    margin-bottom: 40px;
}

.update-card {
    background: #fff;
    padding: 20px;
    border-left: 4px solid #0d6efd;
    box-shadow: 0 6px 18px rgba(0,0,0,.08);
}

/* TRUST */
.trust-section {
    padding: 60px 0;
    background: #0f172a;
    color: #fff;
}

/* ================= HERO TOP BAR ================= */
.hero-top {
    position: absolute;
    top: 25px;
    left: 0;
    right: 0;
    z-index: 5;

    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* LOGO */
.hero-logo {
    font-weight: 800;
    font-size: 1.3rem;
    color: #fff;
}

/* ACTIONS */
.hero-actions-top {
    display: flex;
    gap: 15px;
}

/* GLASS BUTTON */
.hero-glass-btn {
    padding: 10px 22px;
    border-radius: 30px;
    font-size: 0.85rem;
    font-weight: 600;
    text-decoration: none;
    color: #fff;

    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.3);

    transition: all .3s ease;
}

.hero-glass-btn:hover {
    background: rgba(255,255,255,0.25);
    transform: translateY(-2px);
}

/* LOGOUT SPECIAL */
.hero-glass-btn.danger {
    background: rgba(239,68,68,0.25);
    border-color: rgba(239,68,68,0.4);
}

.hero-glass-btn.danger:hover {
    background: rgba(239,68,68,0.45);
}

.cb-popup {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.65);
    z-index: 9999;
}

.cb-popup-content {
    width: 420px;
    max-width: 90%;
    margin: 6% auto;
    padding: 30px;
    background: rgba(255,255,255,.96);
    border-radius: 18px;
    box-shadow: 0 40px 90px rgba(0,0,0,.35);
    position: relative;
    animation: popupFade .4s ease;
}

@keyframes popupFade {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.cb-popup-content input {
    width: 100%;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 10px;
    border: 1px solid #ddd;
}

.cb-close {
    position: absolute;
    top: 14px;
    right: 18px;
    font-size: 20px;
    cursor: pointer;
    opacity: .7;
}

.cb-close:hover {
    opacity: 1;
}
.action-card-link {
  text-decoration: none;
  color: inherit;
}

.action-card {
  background: #ffffff;
  border-radius: 12px;
  padding: 25px;
  text-align: center;
  height: 100%;
  transition: all 0.3s ease;
  box-shadow: 0 10px 25px rgba(0,0,0,0.06);
  cursor: pointer;
}

.action-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 15px 35px rgba(0,0,0,0.12);
}

.action-card h5 {
  font-weight: 600;
  margin-bottom: 10px;
}


.hero-search-wrapper {
    position: relative;
    max-width: 380px;
    margin: 30px auto 0;
}

.hero-search-input {
    width: 100%;
    padding: 12px 16px 12px 42px;
    border-radius: 30px;
    border: none;
    outline: none;
    font-size: 15px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.search-icon {
    position: absolute;
    top: 50%;
    left: 15px;
    transform: translateY(-50%);
    font-size: 16px;
    opacity: 0.6;
}

.search-result {
    margin-top: 8px;
    background: #fff;
    color: #0d6efd;
    border-radius: 10px;
    padding: 10px 14px;
    font-size: 14px;
    display: none;
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
}

</style>


<!-- ================= HERO SECTION ================= -->
<section class="cb-hero cb-hero-full">

    <div class="hero-overlay"></div>

    <!-- HERO TOP BAR -->
    <div class="hero-top container">
        <div class="hero-logo">
            COLOR BLACK 19
        </div>

        <div class="hero-actions-top">
            <a href="{% url 'about' %}"  class="hero-glass-btn">
                About Us
            </a>

            {% if request.user.is_authenticated %}
                <a href="{% url 'logout' %}" class="hero-glass-btn danger">
                    Logout
                </a>
            {% endif %}
        </div>
    </div>

    <div class="hero-content container">

<h1 class="brand-title">Manage School Life With Confidence</h1>

<p class="brand-subtitle">
    An all-in-one platform for fees management, attendance, and student record
</p>

<small class="brand-tagline">
    Trusted by schools ‚Ä¢ Secure by design ‚Ä¢ Powered by M-Pesa
</small>



<div class="hero-actions">
{% if request.user.is_authenticated %}
<div class="hero-search-wrapper">
    <span class="search-icon">üîç</span>
    <input 
        type="text"
        id="studentSearch"
        class="hero-search-input"
        placeholder="Type here to search student..."
        autocomplete="off"
    >

    <div id="searchResult" class="search-result"></div>
</div>

{% else %}
<a href="{% url 'login' %}" class="btn btn-outline-light btn-lg">
    üîê Login
</a>
{% endif %}

        </div>
    </div>
</section>

<!-- ================= QUICK ACTIONS ================= -->
<section class="quick-actions">
  <div class="container">
    <div class="row g-4 text-center">

      <div class="col-md-3">
  <a href="{% url 'students_list' %}"  class="action-card-link">
    <div class="action-card">
      <h5>üéì Student Information</h5>
      <p>View your child‚Äôs class, enrollment details, and fee balance.  
        Stay informed and support their academic journey with ease</p>
    </div>
  </a>
</div>

<div class="col-md-3">
  <a href="{% url 'public_feestructure' %}" class="action-card-link">
    <div class="action-card">
      <h5>üí≥ Fee Structure</h5>
      <p>View the official school fee structure clearly and transparently.
         See required amounts, payment schedules, and important notes for each class.</p>
    </div>
  </a>
</div>

<div class="col-md-3">
          <a href="{% url 'public_events' %}" class="action-card-link">

            <div class="action-card">
        View Events
       <h5>üìÖSchool Events</h5>
        <p>
        View upcoming school events, meetings, activities,
        and important dates.
       </p>
      </div>
    </a>
   </div>

<div class="col-md-3">
    <a href="{% url 'student_reports' %}" class="action-card-link">
        <div class="action-card">
            <h5>üéì Academic Reports</h5>
            <p>
                Access midterm and end-term academic reports securely.
                View grades, teacher remarks, and overall student performance...
            </p>
        </div>
    </a>
</div>



    </div>
  </div>
</section>


<!-- ================= SCHOOL UPDATES ================= -->
<section class="school-updates">
    <div class="container">
        <h3 class="section-title">üì¢ School Updates</h3>

        <div class="row g-4">

            <div class="col-md-4">
                <div class="update-card">
                    <h6>üìå Term Opening</h6>
                    <p>School opens on 5th January. All students to report on time.</p>
                </div>
            </div>

            <div class="col-md-4">
                <div class="update-card">
                    <h6>üìå Fee Reminder</h6>
                    <p>Parents are reminded to clear balances before exams.</p>
                </div>
            </div>

            <div class="col-md-4">
                <div class="update-card">
                    <h6>üìå New Features</h6>
                    <p>Online fee payment via M-Pesa now available.</p>
                </div>
            </div>

        </div>
    </div>
</section>

<!-- ================= TRUST SECTION ================= -->
<section class="trust-section">
    <div class="container">
        <div class="row text-center">

            <div class="col-md-4">
                <h5>üîí Secure System</h5>
                <p>Your data is safe & protected</p>
            </div>

            <div class="col-md-4">
                <h5>‚ö° Real-Time Updates</h5>
                <p>Instant fees & attendance updates</p>
            </div>

            <div class="col-md-4">
                <h5>üì≤ M-Pesa Integrated</h5>
                <p>Fast & reliable payments</p>
            </div>

        </div>
    </div>
</section>
<footer class="system-footer">
    <div class="footer-left">
        <div class="social-icons">
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
    </div>

    <div class="footer-center">
        <span>¬© COLOR BLACK_19</span>
    </div>

    <div class="footer-right">
        <a href="#" class="top-link">Top ‚Üë</a>
    </div>
</footer>

<style>
    .system-footer {
    bottom: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background-color: #0f172a;
    color: #bdbdbd;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    font-size: 14px;
    z-index: 999;
}

/* SOCIAL ICONS */
.social-icons a {
    color: #bdbdbd;
    margin-right: 12px;
    font-size: 16px;
    text-decoration: none;
}

.social-icons a:hover {
    color: white;
}

/* CENTER LINKS */
.footer-center a {
    color: #bdbdbd;
    margin-left: 15px;
    text-decoration: none;
}

.footer-center a:hover {
    color: white;
}

/* RIGHT SIDE */
.footer-right span {
    margin-right: 20px;
}

.footer-right a {
    color: #bdbdbd;
    text-decoration: none;
}

.footer-right a:hover {
    color: white;
}

</style>

{% if not request.user.is_authenticated %}
<div id="registerPopup" class="cb-popup">
    <div class="cb-popup-content">

        <!-- CLOSE ICON -->
        <span class="cb-close" onclick="closeRegisterPopup()">‚úï</span>

        <h4>Welcome üëã</h4>
        <p class="text-muted text-center mb-3">
            Create an account to manage students
        </p>

        <form method="POST" action="{% url 'register' %}">
            {% csrf_token %}

            <input type="text" name="username" placeholder="Username" required>
            <input type="email" name="email" placeholder="Email" required>
            <input type="password" name="password1" placeholder="Password" required>
            <input type="password" name="password2" placeholder="Confirm Password" required>

            <button type="submit" class="btn btn-primary w-100 mt-2">
                Create Account
            </button>
        </form>
    </div>
</div>
{% endif %}

<script>
function openRegisterPopup() {
    document.getElementById("registerPopup").style.display = "block";
}

function closeRegisterPopup() {
    document.getElementById("registerPopup").style.display = "none";
}

/* AUTO OPEN FOR NEW VISITORS */
window.addEventListener("load", function () {

    // show popup after user starts scrolling OR after few seconds
    setTimeout(() => {
        openRegisterPopup();
    }, 2000); // 2 seconds delay

});




const input = document.getElementById("studentSearch");
const resultBox = document.getElementById("searchResult");

function runSearch() {
    const query = input.value.trim();

    if (query.length < 2) {
        resultBox.style.display = "none";
        return;
    }

    
    fetch("{% url 'search_student' %}?q=" + query)

        .then(res => res.json())
        .then(data => {
            if (data.found) {
                resultBox.innerHTML = `
                    <strong>${data.name}</strong><br>
                    <small>
                        Student is registered in our system.<br>
                        Scroll down to view full student information.
                    </small>
                `;
                resultBox.style.display = "block";
            } else {
                resultBox.innerHTML = `
                    <small style="color:#888;">
                        No student found with that name.
                    </small>
                `;
                resultBox.style.display = "block";
            }
        });
}

// Typing
input.addEventListener("keyup", runSearch);

// ENTER key
input.addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
        e.preventDefault(); // stop page reload
        runSearch();
    }
});
</script>


{% endblock %}
