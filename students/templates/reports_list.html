{% extends "base.html" %}

{% block content %}

<style>
    .section-title {
    font-weight: 600;
    margin-bottom: 0.75rem;
    border-left: 4px solid #0d6efd;
    padding-left: 8px;
}

.form-section p,
.subject-card p {
    margin-bottom: 0.6rem;
}

.subject-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
    border: 1px solid #e0e0e0;
}

input, select, textarea {
    border-radius: 6px !important;
}

textarea {
    min-height: 80px;
}
.main-content {
    padding-top: 70px; /* nafasi ya navbar */
    padding-left: 60px; /* nafasi ya sidebar */
}
</style>





<h4 class="mb-3">
    {% if request.GET.term %}
        {{ request.GET.term }}
    {% else %}
        ALL TERMS
    {% endif %}
    ‚Äì
    {% if request.GET.exam %}
        {% if request.GET.exam == "MID" %}MID TERM{% else %}END TERM{% endif %}
    {% else %}
        ALL EXAMS
    {% endif %}
    EXAMINATION REPORT
</h4>

<div class="container-fluid px-3 px-md-4">
    
        <div class="mb-3">
                 <a href="{% url 'export_broadsheet' %}"class="btn btn-success btn-sm">
               üìä Download Excel
           </a>
       </div>
       
    <form method="get" class="row g-2 mb-3">
    <div class="col-md-3">
        <select name="term" class="form-select">
            <option value="">-- Select Term --</option>
            <option value="T1" {% if request.GET.term == "T1" %}selected{% endif %}>Term 1</option>
            <option value="T2" {% if request.GET.term == "T2" %}selected{% endif %}>Term 2</option>
            <option value="T3" {% if request.GET.term == "T3" %}selected{% endif %}>Term 3</option>
        </select>
    </div>

    <div class="col-md-3">
        <select name="exam" class="form-select">
            <option value="">-- Select Exam --</option>
            <option value="MID" {% if request.GET.exam == "MID" %}selected{% endif %}>Mid Term</option>
            <option value="END" {% if request.GET.exam == "END" %}selected{% endif %}>End Term</option>
        </select>
    </div>

    <div class="col-md-3">
        <button type="submit" class="btn btn-primary">
            üîç Filter
        </button>

    </div>
    
</form>


<table class="table table-bordered">
<tr>
    <th>Student</th>
    <th>Term</th>
    <th>Status</th>
    <th>Actions</th>
</tr>

{% for report in reports %}
<tr>
    <td>{{ report.student }}</td>
    <td>{{ report.get_term_display }}</td>
    <td>
        <span class="badge {% if report.status == "PUBLISHED" %}bg-success{% else %}bg-secondary{% endif %}">
            {{ report.status }}
        </span>
        
    </td>
<td>
    <a href="{% url 'edit_report' report.id %}"
       class="btn btn-sm btn-warning">
        ‚úè Edit
    </a>

    <a href="{% url 'publish_report' report.id %}"
       class="btn btn-sm btn-info">
        {% if report.is_published %}Unpublish{% else %}Publish{% endif %}
    </a>

    <a href="{% url 'delete_report' report.id %}"
       class="btn btn-sm btn-danger"
       onclick="return confirm('Are you sure you want to delete this report?');">
        üóë Delete
    </a>
</td>

</tr>
{% endfor %}
</table>
</div>
{% endblock %}
